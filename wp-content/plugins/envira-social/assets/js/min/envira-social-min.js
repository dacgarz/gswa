function envira_social_get_query_arg(e,a){e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=o.exec(a);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function envira_clean_base_link(e){return e=envira_remove_URL_parameter(e,"doing_wp_cron"),e=envira_remove_URL_parameter(e,"envira_social_gallery_id"),e=envira_remove_URL_parameter(e,"envira_social_gallery_item_id"),e=envira_remove_URL_parameter(e,"rand"),e=envira_remove_URL_parameter(e,"envira"),e=envira_remove_URL_parameter(e,"envira_album"),e=envira_remove_URL_parameter(e,"album_id")}function envira_remove_URL_parameter(e,a){var o=e.split("?");if(o.length>=2){for(var i=encodeURIComponent(a)+"=",n=o[1].split(/[&;]/g),t=n.length;t-- >0;)-1!==n[t].lastIndexOf(i,0)&&n.splice(t,1);return e=o[0]+(n.length>0?"?"+n.join("&"):"")}return e}jQuery(document).ready(function($){$(document).on("click",".envira-social-buttons a",function(e){e.preventDefault();var a=window.location.hash,o=$(this).attr("href"),i=$(this).parent().data("width"),n=$(this).parent().data("height"),t=$(this).parent().data("network"),l=$(this).parent().data("deeplinking"),r=!1,c=!1;if($(".envira-pagination").length>0&&(r=envira_social_get_query_arg("page",$(this).attr("href")),r||(r=$(this).closest(".envira-gallery-wrap").find(".envira-pagination").data("page"),r||(r=$("img.envirabox-image").data("pagination-page")))),r)var c=r+"/";else var c="";if("#"==o){var d=$(".envirabox-wrap"),s=d.data("envira-src"),g=d.data("envira-title"),p=d.data("envira-caption"),_=d.data("envira-gallery-id"),v=d.data("envira-item-id"),u=Math.floor(1e4*Math.random()+1),h=envira_social_get_query_arg("envira",window.location.href);h="undefined"!=typeof h&&null!==h?"envira="+h:"",envira_social.debug&&(console.log("detected gallery_id (lightbox):"+_),console.log("detected gallery_item_id (lightbox):"+v),console.log("detected hash:"+a),console.log("detected envira_permalink:"+h)),"undefined"==typeof g&&(p=""),"undefined"==typeof p&&(p="");var f=a.length>0?window.location.href.split("#")[0]:window.location.href.split("?")[0];switch(envira_social.debug&&console.log("base_link (lightbox):"+f),f=envira_clean_base_link(f),envira_social.debug&&console.log("base_link cleaned (lightbox):"+f),x=a.length>0?f+"?envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+v+"&rand="+u+"&"+h+a:f+c+"?envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+v+"&rand="+u+"&"+h,envira_social.debug&&console.log("link (lightbox):"+x),t){case"facebook":var m="",b="",g="",y="";"undefined"!=typeof $(this).attr("data-envira-social-facebook-text")&&(b=decodeURIComponent($(this).data("envira-social-facebook-text")),b=b.replace(new RegExp("\\+","g")," "),""==$.trim(b)&&(b=" "),envira_social.debug&&(console.log("updating facebook_text"),console.log(b))),"undefined"!=typeof $(this).attr("data-envira-facebook-quote")&&(m=decodeURIComponent($(this).data("envira-facebook-quote")),m=m.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote"),console.log(m))),"undefined"!=typeof $(this).attr("data-envira-title")&&(g=decodeURIComponent($(this).data("envira-title")),g=g.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title"),console.log(g))),"undefined"!=typeof $(this).attr("data-facebook-tags-manual")?(y=decodeURIComponent($(this).data("facebook-tags-manual")),y=y.replace(new RegExp("\\+","g")," "),y=y.replace(/-/g,""),envira_social.debug&&(console.log("updating tags"),console.log(y))):envira_social.debug&&(console.log("updating tags - missing"),console.log($(this).attr("data-facebook-tags-manual"))),o="https://www.facebook.com/dialog/feed?app_id="+envira_social.facebook_app_id+"&display=popup&link="+x+"&picture="+s+"&name="+g+"&caption="+p+"&description="+b+"&redirect_uri="+x+"#envira_social_sharing_close";break;case"twitter":var w="";"undefined"!=typeof $(this).attr("data-envira-social-twitter-text")&&(w=decodeURIComponent($(this).data("envira-social-twitter-text")),w=w.replace(new RegExp("\\+","g")," "),console.log("updating twitter_text")),envira_social.debug&&(console.log("updating twitter_text"),console.log(w)),o="https://twitter.com/intent/tweet?text="+$.trim($.trim(p)+" "+$.trim(w))+"&url="+encodeURIComponent(x),envira_social.debug&&(console.log("facebook url (lightbox):"),console.log(o));break;case"google":o="https://plus.google.com/share?url="+encodeURIComponent(x),envira_social.debug&&(console.log("google url (lightbox):"),console.log(o));break;case"pinterest":o="http://pinterest.com/pin/create/button/?url="+x+"&media="+s+"&description="+p,envira_social.debug&&(console.log("pinterest url (lightbox):"),console.log(o));break;case"email":if(envira_social.debug&&(console.log("envira_permalink (lightboxx):"),console.log(h),console.log(h.length)),"undefined"!=typeof h&&null!==h&&h.length>0)var k=a.length>0?f+"?"+h+a:f+c+"?"+h;else var k=a.length>0?f+"?"+a:f+c;o="mailto:?subject="+encodeURIComponent(p)+"&body=Photo: "+s+"%0D%0AURL: "+k,envira_social.debug&&(console.log("email url (lightbox):"),console.log(o),console.log(x))}}else{var _=$(this).data("envira-gallery-id"),v=$(this).data("envira-item-id"),u=Math.floor(1e4*Math.random()+1),h=envira_social_get_query_arg("envira",window.location.href);if(envira_social.debug&&(console.log("detected gallery_id (gallery): "+_),console.log("detected gallery_item_id (gallery): "+v)),"undefined"!=typeof $(this).attr("data-envira-album-id")){var R=$(this).data("envira-album-id");envira_social.debug&&(console.log("album_id is currently:"),console.log(R))}else var R=!1;switch(h="undefined"!=typeof h?"envira="+h:"",envira_social.debug&&console.log("envira_permalink:"+h),t){case"facebook":var m="",b="",g="",y="",p="",s="";if("undefined"!=typeof $(this).attr("data-envira-social-facebook-text")&&(b=decodeURIComponent($(this).data("envira-social-facebook-text")),b=b.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating facebook_text:"),console.log(b))),"undefined"!=typeof $(this).attr("data-envira-caption")){var p=decodeURIComponent($(this).data("envira-facebook-caption"));p=p.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating caption:"),console.log(p))}"undefined"!=typeof $(this).attr("data-envira-facebook-quote")&&(m=decodeURIComponent($(this).data("envira-facebook-quote")),m=m.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote:"),console.log(m))),"undefined"!=typeof $(this).attr("data-envira-title")&&(g=decodeURIComponent($(this).data("envira-title")),g=g.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title:"),console.log(g))),"undefined"!=typeof $(this).attr("data-envira-facebook-tags")&&(y=decodeURIComponent($(this).data("envira-facebook-tags")),y=y.replace(new RegExp("\\+","g")," "),y=y.replace(/-/g,""),envira_social.debug&&(console.log("updating tags:"),console.log(y))),"undefined"!=typeof $(this).attr("data-envira-social-picture")&&(s=decodeURIComponent($(this).data("envira-social-picture")),s=s.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating image:"),console.log(s)));var x=a.length>0?window.location.href.split("#")[0]+encodeURIComponent(a)+"&envira_album_id="+R+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+v:window.location.href.split("?")[0]+c+"?envira_album_id="+R+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+v+"&rand="+u+"&"+h;break;case"pinterest":var U="",C="pin-one",s="";"undefined"!=typeof $(this).attr("data-envira-social-pinterest-description")&&(U=decodeURIComponent($(this).data("envira-social-pinterest-description")),U=U.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest description"),console.log(U))),"undefined"!=typeof $(this).attr("data-envira-social-picture")&&(s=decodeURIComponent($(this).data("envira-social-picture")),s=s.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest image"),console.log(s))),"undefined"!=typeof $(this).attr("data-envira-pinterest-type")&&(C=decodeURIComponent($(this).data("envira-pinterest-type")),C=C.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest ptype"),console.log(C)));var x=a.length>0?window.location.href.split("#")[0]+encodeURIComponent(a)+"&envira_album_id="+R+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+v+"&"+h:window.location.href.split("?")[0]+"?envira_album_id="+R+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+v+"&rand="+u+"&"+h;envira_social.debug&&(console.log("pinterest link:"),console.log(s))}}if("pinterest"===t)"undefined"==typeof U&&"undefined"!=typeof p?U=p:"undefined"==typeof U&&(U=""),"pin-all"==C?PinUtils.pinAny({media:s,description:U,url:x}):PinUtils.pinOne({media:s,description:U,url:x});else if("facebook"===t){if(a.length>0)var I=x;else if(x.length>0)var I=x;else var I=window.location.href;envira_social.debug&&(console.log("sending facebook link:"),console.log(I)),FB.ui({method:"share",display:"popup",href:I,title:g,description:b,caption:p,picture:s,hashtag:y,quote:m})}else if("email"===t)window.location=o;else{var E=window.open(o,"Share","width="+i+",height="+n);envira_social.debug&&(console.log("url:"),console.log(o),console.log(encodeURIComponent(o)))}return!1}),$("div.envira-gallery-item-inner").each(function(){0===$(this).find(".envira-social-buttons .envira-social-network").length&&$(this).find("div.envira-social-buttons").remove()}),location.href.search("envira_social_sharing_close")>-1&&window.close()}),document.getElementsByClassName("button-facebook").onclick=function(){FB.ui({method:"share",display:"popup",href:"https://developers.facebook.com/docs/"},function(e){})};